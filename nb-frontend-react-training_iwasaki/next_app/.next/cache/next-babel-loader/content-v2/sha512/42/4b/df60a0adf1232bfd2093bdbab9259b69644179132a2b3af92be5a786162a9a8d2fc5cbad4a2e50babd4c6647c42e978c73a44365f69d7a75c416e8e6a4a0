{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState, useEffect } from 'react';\nimport usePersist from './persist';\nexport default function Calc(props) {\n  const {\n    0: massage,\n    1: setMessage\n  } = useState('');\n  const {\n    0: input,\n    1: setInput\n  } = useState('');\n  const [data, setData] = usePersist('calc-history', []);\n  const {\n    0: func,\n    1: setFunc\n  } = useState({\n    func: {}\n  });\n\n  const fetchFunc = address => fetch(address).then(res => res.json());\n\n  useEffect(() => {\n    fetchFunc('/api/func').then(r => {\n      setFunc(r);\n    });\n  }, [data]);\n\n  const onChange = e => {\n    setInput(e.target.value);\n  };\n\n  const onKeyPress = e => {\n    if (e.key == 'Enter') {\n      doAction(e);\n    }\n  }; //Enter時の処理\n\n\n  const doAction = e => {\n    const res = eval(input);\n    setMessage(res);\n    data.unshift(input + ' = ' + res);\n    setData(data);\n    setInput('');\n  }; //履歴のクリア\n\n\n  const clear = e => {\n    setData([]);\n    setMessage('Clear history');\n  }; //関数ボタンの処理\n\n\n  const doFunc = e => {\n    const arr = input.split(',');\n    const fid = e.target.id;\n    const f = func.func[fid];\n    const fe = eval(f.function);\n    const res = fe(arr);\n    setMessage(res);\n    data.unshift(fid + ' = ' + res);\n    setData(data);\n    setInput('');\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"alert alert-primary\",\n      children: [/*#__PURE__*/_jsxs(\"h5\", {\n        children: [\"Result: \", message]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"form-group\",\n        children: /*#__PURE__*/_jsx(\"input\", {\n          type: \"text\",\n          value: input,\n          className: \"form-control\",\n          onChange: onChange,\n          onKeyPress: onKeyPress\n        })\n      }), Object.entries(func.func).map((value, key) => /*#__PURE__*/_jsx(\"button\", {\n        className: \"btn btn-secoundary m-1\",\n        title: value[1].caption,\n        id: value[0],\n        onClick: doFunc,\n        children: value[0]\n      }, key))]\n    }), /*#__PURE__*/_jsxs(\"table\", {\n      className: \"table\",\n      children: [/*#__PURE__*/_jsx(\"thead\", {\n        children: /*#__PURE__*/_jsx(\"tr\", {\n          children: /*#__PURE__*/_jsx(\"th\", {\n            children: \"Histroy:\"\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"tbody\", {\n        children: data.map((value, key) => /*#__PURE__*/_jsx(\"tr\", {\n          children: /*#__PURE__*/_jsx(\"td\", {\n            children: value\n          })\n        }, key))\n      })]\n    }), /*#__PURE__*/_jsx(\"button\", {\n      onClick: clear,\n      className: \"btn btn-warning\",\n      children: \"Clear Histroy\"\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}